import { useEvent, useWrapElement } from 'ariakit-utils/hooks';
import { createHook, createComponent, createElement } from 'ariakit-utils/system';
import { useDialogDisclosure } from '../dialog/dialog-disclosure.js';
import { P as PopoverContext } from '../__utils-3e6151ed.js';
import { usePopoverAnchor } from './popover-anchor.js';
import { jsx } from 'react/jsx-runtime';

const usePopoverDisclosure = createHook(_ref => {
  let {
    state,
    ...props
  } = _ref;
  const onClickProp = props.onClick;
  const onClick = useEvent(event => {
    state.anchorRef.current = event.currentTarget;
    onClickProp == null ? void 0 : onClickProp(event);
  });
  props = useWrapElement(props, element => /*#__PURE__*/jsx(PopoverContext.Provider, {
    value: state,
    children: element
  }), [state]);
  props = { ...props,
    onClick
  };
  props = usePopoverAnchor({
    state,
    ...props
  });
  props = useDialogDisclosure({
    state,
    ...props
  });
  return props;
});
/**
 * A component that renders a button that controls the visibility of the popover
 * when clicked.
 * @see https://ariakit.org/components/popover
 * @example
 * ```jsx
 * const popover = usePopoverState();
 * <PopoverDisclosure state={popover}>Disclosure</PopoverDisclosure>
 * <Popover state={popover}>Popover</Popover>
 * ```
 */

const PopoverDisclosure = createComponent(props => {
  const htmlProps = usePopoverDisclosure(props);
  return createElement("button", htmlProps);
});

if (process.env.NODE_ENV !== "production") {
  PopoverDisclosure.displayName = "PopoverDisclosure";
}

export { PopoverDisclosure, usePopoverDisclosure };
