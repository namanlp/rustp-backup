'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var react = require('react');
var hooks = require('ariakit-utils/hooks');

/**
 * Provides state for the `Disclosure` components.
 * @example
 * ```jsx
 * const disclosure = useDisclosureState();
 * <Disclosure state={disclosure}>Disclosure</Disclosure>
 * <DisclosureContent state={disclosure}>Content</DisclosureContent>
 * ```
 */
function useDisclosureState(_temp) {
  var _props$defaultOpen;

  let {
    animated = false,
    ...props
  } = _temp === void 0 ? {} : _temp;
  const disclosureRef = react.useRef(null);
  const [open, setOpen] = hooks.useControlledState((_props$defaultOpen = props.defaultOpen) != null ? _props$defaultOpen : false, props.open, props.setOpen);
  const [contentElement, setContentElement] = react.useState(null);
  const [animating, setAnimating] = react.useState(!!animated && open);
  const prevOpen = hooks.usePreviousValue(open);
  const mounted = open || animating;

  if (animated && !animating && prevOpen !== open) {
    setAnimating(true);
  }

  const show = react.useCallback(() => setOpen(true), [setOpen]);
  const hide = react.useCallback(() => setOpen(false), [setOpen]);
  const toggle = react.useCallback(() => setOpen(v => !v), [setOpen]);
  const stopAnimation = react.useCallback(() => setAnimating(false), []);
  const state = react.useMemo(() => ({
    disclosureRef,
    open,
    mounted,
    animated,
    animating,
    contentElement,
    setContentElement,
    setOpen,
    show,
    hide,
    toggle,
    stopAnimation
  }), [open, mounted, animated, animating, contentElement, setContentElement, setOpen, show, hide, toggle, stopAnimation]);
  return state;
}

exports.useDisclosureState = useDisclosureState;
